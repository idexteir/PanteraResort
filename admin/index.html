<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<base href="../">
<title>Pantera Resort — Admin</title>
<link rel="icon" href="public/images/logo.png" />
<link rel="stylesheet" href="styles.css?v=2025-11-06-2" />
<style>
  table { width:100%; border-collapse:collapse; }
  th,td{ padding:8px 10px; border-bottom:1px solid #eee; text-align:left; }
  th{ background:#faf7f2; position:sticky; top:0; }
  .err{ color:#b00020; font-weight:600; }
  .ok{ color:#056839; font-weight:600; }
  .actions{ display:flex; gap:8px; flex-wrap:wrap; }
  .edit-btn{ background:#fff; border:1px solid var(--accent); }
  .edit-btn:hover{ background:var(--accent); color:#fff; }
  button.btn{ color:inherit; font-size:inherit; cursor:pointer; }
  button.btn.ghost{ color:var(--accent); background:#fff; }
  button.btn.ghost:hover{ background:var(--sand-50); }
  .modal-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,.4);
    display:none; align-items:center; justify-content:center; z-index:50; }
  .modal{ width:min(720px,95vw); background:#fff; border-radius:16px; box-shadow:var(--shadow); padding:16px; }
  .modal-grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:12px; }
  .input,.select,.textarea{ width:100%; padding:10px; border:1px solid var(--sand-400); border-radius:10px; }
  .textarea{ min-height:80px; resize:vertical; }
</style>
</head>
<body>
<div class="container">
  <nav class="nav">
    <div class="brand">
      <img class="logo" src="public/images/logo.png" alt="logo">
      <div class="title">Pantera Resort — Admin</div>
    </div>
    <div class="links">
      <a href="../">Site</a>
      <a href="../menu/">Menu</a>
      <button id="login" class="btn ghost" type="button">Sign in with Google</button>
      <button id="logout" class="btn" type="button" style="display:none">Sign out</button>
    </div>
  </nav>

  <section class="card" id="guard">
    <p><strong>Staff only.</strong> Sign in with a whitelisted Google account.</p>
  </section>

  <section class="card" id="flash" style="display:none"></section>

  <section class="card" id="form-card" style="display:none">
    <h3>Add Item</h3>
    <form id="item-form">
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px">
        <label>Category<input name="category" required class="input"></label>
        <label>Price (SAR)<input name="price" required type="number" step="0.01" class="input"></label>
        <label>Name (EN)<input name="name_en" required class="input"></label>
        <label>Name (AR)<input name="name_ar" dir="rtl" class="input"></label>
        <label>Description (EN)<input name="desc_en" class="input"></label>
        <label>Description (AR)<input name="desc_ar" dir="rtl" class="input"></label>
        <label>Image URL<input name="image" class="input"></label>
        <label>Available<select name="available" class="select">
          <option value="true" selected>Yes</option><option value="false">No</option></select></label>
        <label>Display Order<input name="display_order" type="number" value="0" class="input"></label>
      </div>
      <button class="btn primary" type="submit" style="margin-top:12px">Add</button>
    </form>
  </section>

  <section class="card" id="list-card" style="display:none">
    <h3>Items</h3>
    <div id="items">Loading…</div>
  </section>

  <footer class="footer">© <span id="year"></span> Pantera Resort</footer>
</div>

<!-- Edit Modal -->
<div class="modal-backdrop" id="modal-backdrop">
  <div class="modal">
    <h3>Edit Item</h3>
    <form id="edit-form">
      <input type="hidden" name="id">
      <div class="modal-grid">
        <label>Category<input name="category" class="input" required></label>
        <label>Price (SAR)<input name="price" class="input" type="number" step="0.01" required></label>
        <label>Name (EN)<input name="name_en" class="input" required></label>
        <label>Name (AR)<input name="name_ar" class="input" dir="rtl"></label>
        <label>Description (EN)<textarea name="desc_en" class="textarea"></textarea></label>
        <label>Description (AR)<textarea name="desc_ar" class="textarea" dir="rtl"></textarea></label>
        <label>Image URL<input name="image" class="input"></label>
        <label>Available<select name="available" class="select">
          <option value="true">Yes</option><option value="false">No</option></select></label>
        <label>Display Order<input name="display_order" class="input" type="number" value="0"></label>
      </div>
      <div style="text-align:right;margin-top:12px">
        <button type="button" id="cancel-edit" class="btn">Cancel</button>
        <button type="submit" class="btn primary">Save</button>
      </div>
    </form>
  </div>
</div>

<!-- Scripts (defer, in order) -->
<script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script defer src="scripts/supa.js?v=2025-11-06-2"></script>
<script defer src="scripts/admin.js"></script>
</body>
</html>
